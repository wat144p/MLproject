22:18:47.189 | INFO    | prefect - Starting temporary server on http://127.0.0.1:8687
See https://docs.prefect.io/v3/concepts/server#how-to-guides for more information on running a dedicated Prefect server.
22:18:53.503 | INFO    | Flow run 'amorphous-barracuda' - Beginning flow run 'amorphous-barracuda' for flow 'Stock Risk Training Flow'
22:18:53.905 | INFO    | Task run 'get_data_task-c1a' - Finished in state Completed()
22:18:53.915 | INFO    | Task run 'validate_data_task-80a' - Finished in state Completed()
22:18:53.942 | INFO    | Task run 'feature_engineering_task-825' - Finished in state Completed()
22:18:53.951 | ERROR   | Task run 'split_data_task-daf' - Task run failed with exception: AttributeError("'DatetimeArray' object has no attribute 'sort_values'")
Traceback (most recent call last):
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 990, in run_context
    yield self
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1644, in run_task_sync
    engine.call_task_fn(txn)
    ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1007, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\utilities\callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\flows\training_flow.py", line 27, in split_data_task
    return split_data(df, test_days=TEST_SIZE_DAYS)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\ml\feature_engineering.py", line 78, in split_data
    split_date = pd.to_datetime(dates).sort_values()[-test_days]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DatetimeArray' object has no attribute 'sort_values'
22:18:53.961 | ERROR   | Task run 'split_data_task-daf' - Finished in state Failed("Task run encountered an exception AttributeError: 'DatetimeArray' object has no attribute 'sort_values'")
22:18:53.963 | ERROR   | Flow run 'amorphous-barracuda' - Encountered exception during execution: AttributeError("'DatetimeArray' object has no attribute 'sort_values'")
Traceback (most recent call last):
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 797, in run_context
    yield self
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 1425, in run_flow_sync
    engine.call_flow_fn()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 817, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\utilities\callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\flows\training_flow.py", line 57, in training_flow
    train_df, test_df = split_data_task(df_features)
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\tasks.py", line 1200, in __call__
    return run_task(
        task=self,
    ...<2 lines>...
        return_type=return_type,
    )
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1871, in run_task
    return run_task_sync(**kwargs)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1646, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 610, in result
    raise self._raised
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 990, in run_context
    yield self
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1644, in run_task_sync
    engine.call_task_fn(txn)
    ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1007, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\utilities\callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\flows\training_flow.py", line 27, in split_data_task
    return split_data(df, test_days=TEST_SIZE_DAYS)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\ml\feature_engineering.py", line 78, in split_data
    split_date = pd.to_datetime(dates).sort_values()[-test_days]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DatetimeArray' object has no attribute 'sort_values'
Starting local training run...
Loading AAPL from cache...
Loading MSFT from cache...
Loading GOOGL from cache...
Loading AMZN from cache...
Loading TSLA from cache...
22:18:53.998 | INFO    | Flow run 'amorphous-barracuda' - Finished in state Failed("Flow run encountered an exception: AttributeError: 'DatetimeArray' object has no attribute 'sort_values'")
Traceback (most recent call last):
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\scripts\run_training_locally.py", line 12, in <module>
    training_flow()
    ~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flows.py", line 1713, in __call__
    return run_flow(
        flow=self,
    ...<2 lines>...
        return_type=return_type,
    )
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 1582, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 1427, in run_flow_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 363, in result
    raise self._raised
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 797, in run_context
    yield self
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 1425, in run_flow_sync
    engine.call_flow_fn()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\flow_engine.py", line 817, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\utilities\callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\flows\training_flow.py", line 57, in training_flow
    train_df, test_df = split_data_task(df_features)
                        ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\tasks.py", line 1200, in __call__
    return run_task(
        task=self,
    ...<2 lines>...
        return_type=return_type,
    )
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1871, in run_task
    return run_task_sync(**kwargs)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1646, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ~~~~~~~~~~~~~^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 610, in result
    raise self._raised
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 990, in run_context
    yield self
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1644, in run_task_sync
    engine.call_task_fn(txn)
    ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\task_engine.py", line 1007, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File "C:\Users\jtenn\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\prefect\utilities\callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\flows\training_flow.py", line 27, in split_data_task
    return split_data(df, test_days=TEST_SIZE_DAYS)
  File "C:\Users\jtenn\OneDrive\Desktop\ML Project\ml\feature_engineering.py", line 78, in split_data
    split_date = pd.to_datetime(dates).sort_values()[-test_days]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DatetimeArray' object has no attribute 'sort_values'
22:18:54.170 | WARNING | EventsWorker - Still processing items: 12 items remaining...
22:18:54.260 | INFO    | prefect - Stopping temporary server on http://127.0.0.1:8687

